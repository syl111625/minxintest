webpackJsonp([22],{"6SSP":function(e,t){},"8ncb":function(e,t){},RJwO:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("bOdI"),i=r.n(s),a={name:"refund",data:function(){return{num:1}},props:{orderDetail:{},index:0},created:function(){console.log(this.orderDetail)},computed:{orderStatus:function(){var e=this.orderDetail.order_status.length-1,t=this.orderDetail.order_status[e].status;return 0===t?"待支付订单":1===t?"支付成功":2===t?"已发货":3===t?"订单完成":4===t?"订单已关闭":5===t?"已评价":void 0}},methods:{setNumber:function(e){0===e?(this.num--,this.num<=1&&(this.$message({message:"退货数量不能为0",type:"info"}),this.num=1)):1===e&&(this.num++,this.num>=this.orderDetail.order_detail[this.index].amount&&(this.$message({message:"退货数量不能大于购买数量",type:"info"}),this.num=this.orderDetail.order_detail[this.index].amount))}},watch:{num:function(e){var t=this.orderDetail.order_detail[this.index].price;e<=0?e=1:e>=this.orderDetail.order_detail[this.index].amount&&(e=this.orderDetail.order_detail[this.index].amount),this.num=e;var r={index:this.index,amount:e,price:t};this.$emit("refundAmount",r)}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"refund"},[s("ul",{staticClass:"item"},[s("li",[s("div",{staticClass:"img"},[e.orderDetail.order_detail[e.index].goods.goods_images.length>0?s("img",{attrs:{src:e.orderDetail.order_detail[e.index].goods.goods_images[0].imageUrl,alt:"..."}}):e._e(),e._v(" "),0===e.orderDetail.order_detail[e.index].goods.goods_images.length?s("img",{attrs:{src:r("ADp8"),alt:"..."}}):e._e()]),e._v(" "),s("div",{staticClass:"text"},[s("p",{attrs:{title:e.orderDetail.order_detail[e.index].goods.name}},[e._v(e._s(e.orderDetail.order_detail[e.index].goods.name))]),e._v(" "),s("p",[e._v(e._s(e.orderDetail.order_detail[e.index].goods.detailCpropertyVo[0].value))]),e._v(" "),s("p",[e._v("\n          "+e._s(void 0===e.orderDetail.order_detail[e.index].goods.detailCpropertyVo[1]?"":e.orderDetail.order_detail[e.index].goods.detailCpropertyVo[1].value)+"\n        ")])])]),e._v(" "),s("li",[e._v("￥"+e._s(e.orderDetail.order_detail[e.index].price))]),e._v(" "),s("li",[e._v(e._s(e.orderDetail.order_detail[e.index].amount))]),e._v(" "),s("li",[e._v(e._s(e.orderDetail.order_detail[e.index].refundingAmount))]),e._v(" "),s("li",{staticClass:"control"},[s("i",{staticClass:"fa fa-minus",attrs:{"aria-hidden":"true"},on:{click:function(t){e.setNumber(0)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.num,expression:"num"}],attrs:{type:"text",title:""},domProps:{value:e.num},on:{input:function(t){t.target.composing||(e.num=t.target.value)}}}),e._v(" "),s("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"},on:{click:function(t){e.setNumber(1)}}})]),e._v(" "),s("li",[e._v(e._s(e.orderStatus))]),e._v(" "),s("li",{staticClass:"payment"},[e._v("￥"+e._s(e.orderDetail.order_detail[e.index].price*e.orderDetail.order_detail[e.index].amount))])]),e._v(" "),s("div",{staticClass:"numbering"},[e._v("订单编号："+e._s(e.orderDetail.orderSerialNumber))])])},staticRenderFns:[]};r("VU/8")(a,o,!1,function(e){r("6SSP")},"data-v-0f1c047b",null).exports;var d={data:function(){var e;return e={orderDetail:[],temporderDetail:[],refundAmount:[],returnReasons:[],orderStatu:[],stateid:-1,ocrId:-1,refundmoney:0,maxRefundmoney:0,refunddesc:"",refundamount:0,iamgeUrlArr:["555555"],orderDetailId:0,refundType:0,isif:!1,files:[],uploadLen:6,imgs:[],userDatas:{}},i()(e,"orderDetailId",0),i()(e,"num",1),i()(e,"orderDetail",[]),i()(e,"orderDetailRefund",{}),i()(e,"orderDetailCon",{}),i()(e,"goodStatus",0),i()(e,"iamgeUrl",""),i()(e,"isCanRefund",!0),i()(e,"baseURL",""),e},created:function(){this.getData(),this.getReftCause(),this.getConfig(),this.getbaseURL()},components:{uploader:r("woyf").a},mounted:function(){},methods:{getbaseURL:function(){console.log("获取baseURL---------"),console.log(this.$baseURL),this.baseURL=this.$baseURL},getConfig:function(){this.userDatas.token=this.$cookies.get("token"),this.userDatas.userId=this.$cookies.get("userId"),this.orderDetailId=this.$cookies.get("orderDetailId"),this.refundType=this.$cookies.get("refundType")},getData:function(){var e=this;this.$getAxios({url:"/mall/getOrderDetailByOrderId",method:"get",params:{token:this.$cookies.get("token"),orderId:this.$cookies.get("orderId"),userId:this.$cookies.get("userId")}}).then(function(t){if(1e4===t.data.code){e.orderDetail=t.data.extend.success;var r=e.orderDetail.orderSerialNumber,s=e.orderDetail.orderId,i="";if(null!=e.orderDetail.order_status)for(var a=0;a<e.orderDetail.order_status.length;a++)if(e.orderDetail.order_status[a].isNewStatus){var o=e.orderDetail.order_status[a].status;0===o?(i="待支付订单",e.isCanRefund=!1):1===o?i="支付成功":2===o?i="已发货":3===o?i="订单完成":4===o?(i="订单已关闭",e.isCanRefund=!1):5===o&&(i="已评价")}for(var d=0;d<e.orderDetail.order_detail.length;d++)if(e.orderDetail.order_detail[d].orderDetailId==e.orderDetailId){e.orderDetailRefund=e.orderDetail.order_detail[d];break}var n=e.orderDetailRefund.orderDetailFee,l="",u="";if(null!=e.orderDetailRefund.goods.detailCpropertyVo)for(var c=0;c<e.orderDetailRefund.goods.detailCpropertyVo.length;c++)"【规格】"==e.orderDetailRefund.goods.detailCpropertyVo[c].cpName&&(l=e.orderDetailRefund.goods.detailCpropertyVo[c].value),"【厂家】"==e.orderDetailRefund.goods.detailCpropertyVo[c].cpName&&(u=e.orderDetailRefund.goods.detailCpropertyVo[c].value);var m="";if(null!=e.orderDetailRefund.goods.goods_images)for(var _=0;_<e.orderDetailRefund.goods.goods_images.length;_++){m=e.orderDetailRefund.goods.goods_images[_].imageUrl;break}var f="0元";if(null!=e.orderDetailRefund.order_detail_discount_shareVo)for(var v=0;v<e.orderDetailRefund.order_detail_discount_shareVo.length;v++){f=e.orderDetailRefund.order_detail_discount_shareVo[v].odds_description+" -"+e.orderDetailRefund.order_detail_discount_shareVo[v].odds_discount_share_amount+"元",e.orderDetailRefund.order_detail_discount_shareVo[v].odds_discount_share_amount;break}var g=e.orderDetailRefund.refundedAmount,h={orderId:s,orderSerialNumber:r,name:e.orderDetailRefund.goods.name,specName:l,proName:u,img:m,price:e.orderDetailRefund.price,amount:e.orderDetailRefund.amount,refundedAmount:g,statu:i,orderDetailFee:n,discount:f};e.orderDetailCon=h,e.maxRefundmoney=e.orderDetailCon.orderDetailFee,e.refundmoney=e.num*e.orderDetailRefund.shingleOrderDetailFee,console.log("整理后的------"),console.log(e.orderDetailCon)}}).catch(function(e){console.log(e)})},setNumber:function(e){0===e?(this.num--,this.num<=1&&(this.$message({message:"退货数量不能为0",type:"info"}),this.num=1)):1===e&&(this.num++,this.num>=this.orderDetailCon.amount&&(this.$message({message:"退货数量不能大于购买数量",type:"info"}),this.num=this.orderDetailCon.amount)),this.refundmoney=this.num*this.orderDetailRefund.shingleOrderDetailFee},getReftCause:function(){var e=this;this.$getAxios({url:"/mall/getReftCause",method:"get",params:""}).then(function(t){console.log(t.data),e.returnReasons=t.data.extend.success,console.log(e.returnReasons)}).catch(function(e){console.log(e)})},getOrderStatu:function(){var e=this;this.$getAxios({url:"/mall/getOrderAndAllStatus",method:"get",params:{token:this.$cookies.get("token"),orderId:this.$cookies.get("orderId"),userId:this.$cookies.get("userId")}}).then(function(t){console.log(t.data),e.orderStatu=t.data.extend.success,console.log(e.orderStatu);for(var r=0;r<e.orderStatu.status.length;r++){var s=e.orderStatu.status[r].status;0===s?e.orderStatu.status[r].status="待支付订单":1===s?e.orderStatu.status[r].status="支付成功":2===s?e.orderStatu.status[r].status="已发货":3===s?e.orderStatu.status[r].status="订单完成":4===s?e.orderStatu.status[r].status="订单已关闭":5===s&&(e.orderStatu.status[r].status="已评价")}}).catch(function(e){console.log(e)})},upload:function(){console.log("图片上传显示"),this.isif=!0},getChildrenFile:function(e){console.log(e),this.files=e,console.log(this.files.length)},refundSubmit:function(){var e=this,t=parseInt(this.stateid);if(this.refundmoney>this.maxRefundmoney)this.$message({message:"退款金额不能大于实付金额",type:"info"});else if(this.refundmoney<=0)this.$message({message:"退款金额不能小于或等于0",type:"info"});else if(""==this.ocrId||""==this.refunddesc)this.$message({message:"信息填写不全",type:"info"});else{0==this.files.length&&(this.iamgeUrl="&iamgeUrl[]=");for(var r=0;r<this.files.length;r++)this.iamgeUrl+="&iamgeUrl[]="+this.files[r].Url[0];this.$postAxios({url:"/mall/refund",method:"post",data:"userId="+this.$cookies.get("userId")+"&token="+this.$cookies.get("token")+"&ocrId="+this.ocrId+"&money="+this.refundmoney+"&explain="+this.refunddesc+"&orderDetailId="+this.orderDetailId+"&goodStatus="+t+"&refundType="+this.refundType+"&amount="+this.num+"&orderId="+this.orderDetailCon.orderId+this.iamgeUrl}).then(function(t){2e4!=t.data.code?1e4==t.data.code&&(console.log(t.data),e.$message({message:"申请退款成功",type:"success"}),e.$router.push({name:"refund_after",path:"/refund_after"})):e.$message({message:"申请退款失败,"+t.data.extend.err_code,type:"error"})}).catch(function(e){console.log(e)})}}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-refund"},[e._m(0),e._v(" "),r("div",{staticClass:"goods-list"},[e._m(1),e._v(" "),r("div",{staticClass:"refundcon"},[r("ul",{staticClass:"item"},[r("li",[r("div",{staticClass:"img"},[r("img",{attrs:{src:e.orderDetailCon.img,alt:"..."}})]),e._v(" "),r("div",{staticClass:"text"},[r("p",{attrs:{title:e.orderDetailCon.name}},[e._v(e._s(e.orderDetailCon.name))]),e._v(" "),r("p",[e._v(e._s(e.orderDetailCon.specName))]),e._v(" "),r("p",[e._v(e._s(e.orderDetailCon.proName))])])]),e._v(" "),r("li",[e._v("￥"+e._s(e.orderDetailCon.price))]),e._v(" "),r("li",[e._v(e._s(e.orderDetailCon.amount))]),e._v(" "),r("li",[e._v(e._s(e.orderDetailCon.refundedAmount))]),e._v(" "),r("li",{staticClass:"control"},[r("i",{staticClass:"fa fa-minus",attrs:{"aria-hidden":"true"},on:{click:function(t){e.setNumber(0)}}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.num,expression:"num"}],attrs:{type:"text",title:""},domProps:{value:e.num},on:{input:function(t){t.target.composing||(e.num=t.target.value)}}}),e._v(" "),r("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"},on:{click:function(t){e.setNumber(1)}}})]),e._v(" "),r("li",[e._v(e._s(e.orderDetailCon.statu))]),e._v(" "),r("li",{staticClass:"payment"},[e._v("￥"+e._s(e.orderDetailCon.orderDetailFee))])]),e._v(" "),r("div",{staticClass:"numbering"},[e._v("订单编号："+e._s(e.orderDetailCon.orderSerialNumber))])])]),e._v(" "),e.isCanRefund?r("div",{staticClass:"refund-title"},[r("p",[e._v("申请退款")])]):e._e(),e._v(" "),e.isCanRefund?r("div",{staticClass:"refund-content"},[r("div",{staticClass:"left"},[0==e.refundType?r("p",[r("span",[e._v("*")]),e._v(" 商品状态")]):e._e(),e._v(" "),e._m(2),e._v(" "),r("p",[e._v("退款金额")]),e._v(" "),r("p",[e._v("退款说明")]),e._v(" "),r("p",[e._v("退款凭证")])]),e._v(" "),r("div",{staticClass:"right"},[0==e.refundType?r("div",{staticClass:"status"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.stateid,expression:"stateid"}],attrs:{title:"商品状态"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.stateid=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"0"}},[e._v("未收货")]),e._v(" "),r("option",{attrs:{value:"1"}},[e._v("已收货")])])]):e._e(),e._v(" "),r("div",{staticClass:"reason"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.ocrId,expression:"ocrId"}],attrs:{title:"退款原因"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.ocrId=t.target.multiple?r:r[0]}}},e._l(e.returnReasons,function(t,s){return r("option",{domProps:{value:t.ocrId}},[e._v(e._s(t.orderCloseReason))])}))]),e._v(" "),r("div",{staticClass:"amount"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.refundmoney,expression:"refundmoney"}],attrs:{type:"text",title:"退款金额",disabled:"disabled"},domProps:{value:e.refundmoney},on:{input:function(t){t.target.composing||(e.refundmoney=t.target.value)}}}),e._v(" "),r("span",[e._v("元")])]),e._v(" "),r("div",{staticClass:"description"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.refunddesc,expression:"refunddesc"}],attrs:{type:"text",title:"退款说明"},domProps:{value:e.refunddesc},on:{input:function(t){t.target.composing||(e.refunddesc=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"certificate"},[r("p",[e._v("上传规格图片,推荐图片尺寸38x38px 最多上传5张")]),e._v(" "),r("p",{on:{click:e.upload}},[e._v("上传凭证")]),e._v(" "),e.isif?r("p",{staticClass:"add-img"},[r("uploader",{attrs:{src:e.baseURL+"/mall/userupload/multipicture",files:e.imgs,uploadLen:e.uploadLen,datas:e.userDatas},on:{getFile:e.getChildrenFile}})],1):e._e(),e._v(" "),r("p",{staticClass:"submit"},[r("span",{staticClass:"confirm",on:{click:e.refundSubmit}},[e._v("确认提交")]),e._v(" "),r("span",{staticClass:"cancel"},[e._v("取消")])])])])]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"refund-title"},[t("p",[this._v("订单概况")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"title"},[r("li",[e._v("商品信息")]),e._v(" "),r("li",[e._v("单价")]),e._v(" "),r("li",[e._v("购买数量")]),e._v(" "),r("li",[e._v("已退数量")]),e._v(" "),r("li",[e._v("退货数量")]),e._v(" "),r("li",[e._v("订单状态")]),e._v(" "),r("li",[e._v("实际付款")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("span",[this._v("*")]),this._v(" 退货原因")])}]};var l=r("VU/8")(d,n,!1,function(e){r("8ncb")},"data-v-5f00832b",null);t.default=l.exports}});