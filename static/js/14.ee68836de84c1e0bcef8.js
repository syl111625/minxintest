webpackJsonp([14],{"2grg":function(t,e){},CnmA:function(t,e){},bojt:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={props:{src:{type:String,required:!0},files:{type:Array,default:[]},datas:{type:Object},uploadLen:{type:Number,default:5}},data:function(){return{status:"ready",point:{},uploading:!1,percent:0}},methods:{add:function(){this.$refs.file.click()},submit:function(){var t=this;if(0!==this.files.length){var e=new FormData,s=new XMLHttpRequest;s.upload.addEventListener("progress",this.uploadProgress,!1),s.open("POST",this.src,!0),this.uploading=!0,s.send(e),s.onload=function(){t.uploading=!1,200===s.status||304===s.status?(t.status="finished",console.log("upload success!")):console.log("error：error code "+s.status)}}else console.warn("no file!")},finished:function(){this.files=[],this.status="ready"},remove:function(t){this.files.splice(t,1),this.$emit("getFile",this.files)},fileChanged:function(){var t=this;console.log(this.datas);var e=this.$refs.file.files[0],s=new FormData,a=new XMLHttpRequest;a.open("POST",this.src,!0),s.append("userId",this.datas.userId),s.append("token",this.datas.token),s.append("fileUpload",e),a.send(s),a.onload=function(){if(200===a.status||304===a.status){var s={file:e,Url:JSON.parse(a.responseText).extend.success};t.html5Reader(e,s),console.log(a.responseText),t.files.push(s)}else console.log("error：error code "+a.status);t.$refs.file.value="",t.$emit("getFile",t.files)}},html5Reader:function(t,e){var s=this,a=new FileReader;a.onload=function(t){s.$set(e,"src",t.target.result)},a.readAsDataURL(t)},uploadProgress:function(t){if(t.lengthComputable){var e=Math.round(100*t.loaded/t.total);this.percent=e/100}else console.warn("upload progress unable to compute")}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"vue-uploader"},[s("div",{staticClass:"file-list"},[t._l(t.files,function(e,a){return s("section",{staticClass:"file-item draggable-item"},[s("img",{attrs:{src:e.src,alt:"",ondragstart:"return false;"}}),t._v(" "),s("span",{staticClass:"file-remove",on:{click:function(e){t.remove(a)}}},[t._v("+")])])}),t._v(" "),"ready"==t.status?s("section",{directives:[{name:"show",rawName:"v-show",value:t.files.length<5,expression:"files.length<5"}],staticClass:"file-item"},[s("div",{staticClass:"add",on:{click:t.add}},[s("span",[t._v("+")])])]):t._e()],2),t._v(" "),s("input",{ref:"file",attrs:{type:"file",accept:"image/*",multiple:"multiple"},on:{change:t.fileChanged}})])},staticRenderFns:[]};var n={components:{uploadtwo:s("VU/8")(a,i,!1,function(t){s("2grg")},null,null).exports},data:function(){return{files:[],imgs:[],ImgList:[{},{},{},{},{}],userDatas:{},uploadLen:5,iamgeUrl:"",anonymous:!1,evaluation:"",stars:["","",""],starspan:"-1",starTxt:"",baseURL:"",comment:{orderDetailId:this.orderDetails.orderDetailId,goodsId:this.orderDetails.goods_sku_value.goodId,context:"",stars:0,isAnonymous:!1,imageUrl:[]}}},props:{orderDetails:{},status:{type:Array,default:[]},index:0},filters:{date:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())}},watch:{evaluation:function(t){this.comment.context=t,this.$emit("commentChange",this.comment,this.index)}},mounted:function(){this.userDatas.token=this.$cookies.get("token"),this.userDatas.userId=this.$cookies.get("userId"),this.getbaseURL()},computed:{anonymousChange:function(){return!0===this.anonymous?"color: #1ABC9C":"color: gainsboro"},specification:function(){var t="";return this.orderDetails.goods_sku_value.goods_sku_sell_properties.forEach(function(e){t+=e.category_property_value.value+" "}),t},orderStatus:function(){var t=this.status.length-1,e=this.status[t].status;return 0===e?"待支付订单":1===e?"支付成功":2===e?"发货":3===e?"订单完成":4===e?"已签收":5===e?"已评价":void 0}},methods:{getbaseURL:function(){console.log("获取baseURL---------"),console.log(this.$baseURL),this.baseURL=this.$baseURL},getChildrenFile:function(t){console.log(t),this.files=t,console.log(this.files.length);var e=[];if(0===this.files.length){e.push({imageUrl:""})}else for(var s=0;s<this.files.length;s++){var a={imageUrl:this.files[s].Url[0]};e.push(a)}console.log("------多个图片------"),console.log(e),this.comment.imageUrl=e,this.$emit("commentChange",this.comment,this.index)},starComment:function(t){this.starspan=t,this.comment.stars=t+1,console.log("星星评价"),console.log(t+1),console.log(this.comment.stars),this.$emit("commentChange",this.comment,this.index),0===this.starspan?this.starTxt="差评":1===this.starspan?this.starTxt="中评":2===this.starspan&&(this.starTxt="好评")},anonymousClick:function(){this.anonymous=!this.anonymous,this.comment.isAnonymous=this.anonymous,this.$emit("commentChange",this.comment,this.index)},cancel:function(){this.comment.context="",this.comment.stars=0,this.comment.isAnonymous=!1,this.comment.imageUrl=[],this.starspan="-1",this.evaluation="",this.imgs=[],this.anonymous=!1}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my_comment_box"},[a("div",[t._m(0),t._v(" "),a("div",{staticClass:"orderDetails"},[t._m(1),t._v(" "),a("div",{staticClass:"orderDetails_mid"},[a("ul",[a("li",{staticClass:"fl orderDetails_top1"},[t.orderDetails.goods_sku_value.goods.goods_images.length?a("img",{staticClass:"fl",attrs:{src:t.orderDetails.goods_sku_value.goods.goods_images[0].imageUrl,alt:"..."}}):t._e(),t._v(" "),t.orderDetails.goods_sku_value.goods.goods_images.length?t._e():a("img",{staticClass:"fl",attrs:{src:s("ADp8"),alt:"..."}}),t._v(" "),a("div",{staticClass:"fl orderDetails_top1_txt"},[a("span",[t._v(t._s(t.orderDetails.goods_sku_value.goods.name))]),t._v(" "),a("span",{staticStyle:{color:"#999999"}},[t._v(t._s(t.specification))])])]),t._v(" "),a("li",{staticClass:"fl orderDetails_top2 orderDetailscnetent"},[t._v(t._s("￥"+t.orderDetails.shingleOrderDetailFee))]),t._v(" "),a("li",{staticClass:"fl orderDetails_top3 orderDetailscnetent"},[t._v(t._s(t.orderDetails.amount))]),t._v(" "),a("li",{staticClass:"fl orderDetails_top4 orderDetailscnetent"},[t._v(t._s(t.orderStatus))]),t._v(" "),a("li",{staticClass:"fl orderDetails_top5 orderDetailscnetent"},[t._v("\n                        "+t._s("￥"+t.orderDetails.shingleOrderDetailFee*t.orderDetails.amount)+"\n                    ")])])])]),t._v(" "),t._m(2),t._v(" "),a("div",{staticClass:"comment_centent_box"},[a("div",{staticClass:"comment_centent"},[a("div",{staticClass:"comment_centent1 clear"},[t._m(3),t._v(" "),a("li",{staticClass:"comment_centent_right fl"},[t._l(t.stars,function(e,s){return a("i",{staticClass:"fa starComment",class:[t.starspan>=s?"fa-star":"fa-star-o"],attrs:{"aria-hidden":"true"},on:{click:function(e){t.starComment(s)}}})}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.starspan>=0,expression:"starspan>=0"}]},[t._v(t._s(t.starTxt))])],2)]),t._v(" "),a("div",{staticClass:"clear comment_centent2"},[t._m(4),t._v(" "),a("li",{staticClass:"comment_centent_right fl"},[a("el-input",{staticStyle:{width:"300px"},attrs:{size:"medium",placeholder:"说说你的使用心得,分享给想买的他们吧"},model:{value:t.evaluation,callback:function(e){t.evaluation=e},expression:"evaluation"}})],1)]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),a("div",{staticClass:"clear comment_centent5"},[a("li",{staticClass:"comment_centent_left fl"},[t._v(" ")]),t._v(" "),a("li",{staticClass:"comment_centent_right fl"},[a("uploadtwo",{attrs:{src:t.baseURL+"/mall/userupload/multipicture",files:t.imgs,uploadLen:t.uploadLen,datas:t.userDatas},on:{getFile:t.getChildrenFile}})],1)]),t._v(" "),a("div",{staticClass:"clear comment_centent6"},[t._m(7),t._v(" "),a("li",{staticClass:"comment_centent_right fl",on:{click:function(e){t.anonymousClick()}}},[a("i",{staticClass:"fa fa-check-circle",style:t.anonymousChange})])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navtop"},[e("span",[this._v("订单详情")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderDetails_top"},[s("ul",[s("li",{staticClass:"fl orderDetails_top1"},[t._v("商品信息")]),t._v(" "),s("li",{staticClass:"fl orderDetails_top2"},[t._v("单价")]),t._v(" "),s("li",{staticClass:"fl orderDetails_top3"},[t._v("数量")]),t._v(" "),s("li",{staticClass:"fl orderDetails_top4"},[t._v("订单状态")]),t._v(" "),s("li",{staticClass:"fl orderDetails_top5"},[t._v("实际付款")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"comment_top"},[e("span",[this._v("评论")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"comment_centent_left fl"},[e("span",{staticClass:"fr comment_centent_left_txt"},[this._v("描述相符")]),this._v(" "),e("span",{staticClass:"fr star "},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"comment_centent_left fl",staticStyle:{"line-height":"32px"}},[e("span",{staticClass:"fr comment_centent_left_txt"},[this._v("评价")]),this._v(" "),e("span",{staticClass:"fr star",staticStyle:{"line-height":"32px"}},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"clear comment_centent3"},[e("li",{staticClass:"comment_centent_left fl"},[e("span",{staticClass:"fr comment_centent_left_txt"},[this._v("嗮图")])]),this._v(" "),e("li",{staticClass:"comment_centent_right fl"},[e("span",{staticStyle:{"font-size":"12px"}},[this._v("添加图片")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"clear comment_centent4"},[e("li",{staticClass:"comment_centent_left fl"},[this._v(" ")]),this._v(" "),e("li",{staticClass:"comment_centent_right fl"},[e("button",{staticClass:"btn3"},[this._v("上传凭证")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"comment_centent_left fl"},[e("span",{staticClass:"fr"},[this._v("匿名")])])}]};var l={data:function(){return{orderDetails:[],comment:[]}},created:function(){this.getData()},methods:{commentChange:function(t,e){console.log("-----数据改变-----"),this.comment[e]=t},getData:function(){var t=this,e={userId:this.$cookies.get("userId"),token:this.$cookies.get("token"),orderId:this.$cookies.get("orderId")};this.$getAxios({url:"/mall/getOrderAndAllStatus",method:"get",params:e}).then(function(e){2e4===e.data.code?console.log("获取订单失败"):1e4===e.data.code&&(t.orderDetails=e.data.extend.success,console.log(t.orderDetails),t.initializationComment(t.orderDetails.detail.length))}).catch(function(t){console.log(t)})},initializationComment:function(t){this.comment=[];for(var e=0;e<t;e++){var s={orderDetailId:this.orderDetails.detail[e].orderDetailId,goodsId:this.orderDetails.detail[e].goods_sku_value.goodId,context:"",stars:3,isAnonymous:!1,imageUrl:[]};this.comment.push(s)}},open:function(t,e){this.$message({message:t,type:e})},release:function(){var t=this,e={userId:this.$cookies.get("userId"),token:this.$cookies.get("token"),data:this.comment};console.log(e),this.$jsonAxios({url:"/mall/addGoodsComment",method:"post",data:e}).then(function(e){1e4===e.data.code?(console.log(e),t.open("评论成功","success"),t.getData(),t.cancel()):t.open("评论失败","warning")}).catch(function(t){console.log(t)})},cancel:function(){for(var t=0;t<this.orderDetails.detail.length;t++)this.$refs.my_comment[t].cancel()}},components:{"my-comment":s("VU/8")(n,o,!1,function(t){s("t8tE")},"data-v-63e245a0",null).exports}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-comment"},[t._l(t.orderDetails.detail,function(e,a){return s("div",{staticClass:"wrapper"},[s("my-comment",{ref:"my_comment",refInFor:!0,attrs:{orderDetails:e,status:t.orderDetails.status,index:a},on:{commentChange:t.commentChange}})],1)}),t._v(" "),s("div",{staticClass:"release-wrapper"},[s("div",{staticClass:"btn",on:{click:t.release}},[t._v("发布")]),t._v(" "),s("div",{staticClass:"btn",on:{click:t.cancel}},[t._v("取消")])])],2)},staticRenderFns:[]};var c=s("VU/8")(l,r,!1,function(t){s("CnmA")},"data-v-93539a2c",null);e.default=c.exports},t8tE:function(t,e){}});